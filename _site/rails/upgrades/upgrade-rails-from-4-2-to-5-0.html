<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Article">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    

    <title>Upgrade Rails From 4.2 to 5.0 - The Lean Software Boutique</title>


    
    
    <meta name="description" content="This article is part of our Upgrade Rails series. To see more of them, click here.This article will cover the most important aspects that you need ..." />
    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Upgrade Rails From 4.2 to 5.0 - The Lean Software Boutique">
    <meta itemprop="description" content="This article is part of our Upgrade Rails series. To see more of them, click here.This article will cover the most important aspects that you need ...">
    <!-- meta itemprop="image" content="http://www.example.com/image.jpg" -->

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@OmbuLabs">

    <meta name="twitter:title" content="Upgrade Rails From 4.2 to 5.0 - The Lean Software Boutique">
    <meta name="twitter:description" content="This article is part of our Upgrade Rails series. To see more of them, click here.This article will cover the most important aspects that you need ...">
    <meta name="twitter:creator" content="@OmbuLabs">
    <!-- Twitter summary card with large image must be at least 280x150px -->
    <!-- meta name="twitter:image:src" content="http://www.example.com/image.html" -->

    <!-- Open Graph data -->
    <meta property="og:title" content="Upgrade Rails From 4.2 to 5.0 - The Lean Software Boutique" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://www.ombulabs.com/blog/rails/upgrades/upgrade-rails-from-4-2-to-5-0.html" />
    <meta property="og:image" content="https://www.ombulabs.com/assets/isotype.png" />
    <meta property="og:description" content="This article is part of our Upgrade Rails series. To see more of them, click here.This article will cover the most important aspects that you need to know to getyour Ruby on Rails application from version 4.2 to 5.0." />
    <meta property="og:site_name" content="Upgrade Rails from 4.2 to 5.0 by @mauro_oto" />
    
      <meta property="article:published_time" content="2018-03-01 06:19:00 -0500" />
      <meta property="article:modified_time" content="2018-03-01 06:19:00 -0500" />
      <meta property="article:section" content="This article is part of our Upgrade Rails series. To see more of them, click here.This article will cover the most important aspects that you need to know to getyour Ruby on Rails application from version 4.2 to 5.0." />
      <meta property="article:tag" content="Upgrade Rails From 4.2 to 5.0 - The Lean Software Boutique" />
    

    <meta property="fb:admins" content="10153304864537860" />

    <link rel="stylesheet" type="text/css" href="/blog/assets/css/screen.css" />
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900,300italic,400italic,700italic|Maven+Pro" rel="stylesheet" type="text/css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/blog/assets/css/main.css" />
    <link rel="stylesheet" type="text/css" href="/assets/ombu_blog/application.css" />
</head>
<body class="home-template">
  <header class="main-header no-cover">
      <nav class="main-nav overlay clearfix">
              
              <a class="back-button icon-arrow-left"
                 href="/blog">Home</a>
          <a class="subscribe-button icon-feed" href="/blog/rss.xml">Subscribe</a>
      </nav>
      <div class="vertical">
          <div class="main-header-content inner">
              <h1 class="page-title logo"><a href="/blog">OmbuLabs Blog</a></h1>
              <h2 class="page-description slogan">
                   The Lean Software Boutique 
                  
              </h2>
          </div>
      </div>
      <a class="scroll-down icon-arrow-left" href="#content" data-offset="-45"><span class="hidden">Scroll Down</span></a>
  </header>
    <div id="wrapper">
      <main class="content post-layout" role="main">

    <article class="post">

        <header class="post-header">
            <h1 class="post-title">Upgrade Rails from 4.2 to 5.0</h1>
            <section class="post-meta">
              
              


  
    <img class="author-thumb" src="//2.gravatar.com/avatar/350875eb8fce8553e12040c5a1f5d5d0?s=50" alt="Mauro Otonelli" nopin="nopin" />
  
  <a href="/blog/authors/mauro-oto"
     title="Articles by Mauro Otonelli">
     Mauro Otonelli
  </a>


 
  on
    
      <a href="/blog/tags/rails"
         title="Articles about Rails">Rails</a>,
      <a href="/blog/tags/upgrades"
         title="Articles about Upgrades">Upgrades</a>



<time class="post-date" datetime="2018-03-01">
  01 Mar 2018
</time>

            </section>
        </header>

        <section class="post-content">
          <p><em>This article is part of our Upgrade Rails series. To see more of them, <a href="https://www.ombulabs.com/blog/tags/upgrades">click here</a></em>.</p>

<p>This article will cover the most important aspects that you need to know to get
your <a href="http://rubyonrails.org/">Ruby on Rails</a> application from <a href="http://guides.rubyonrails.org/4_2_release_notes.html">version 4.2</a> to <a href="http://guides.rubyonrails.org/5_0_release_notes.html">5.0</a>.</p>

<!--more-->

<ol>
<li><a href="#ruby-version">Ruby version</a></li>
<li><a href="#gems">Gems</a></li>
<li><a href="#config-files">Config files (config/)</a></li>
<li><a href="#application-code">Application code</a>

<ol>
<li><a href="#active-record">ActiveRecord</a></li>
<li><a href="#controllers">Controllers</a></li>
</ol></li>
<li><a href="#testing">Testing</a></li>
<li><a href="#next-steps">Next steps</a></li>
</ol>

<h2 id="ruby-version">1. Ruby version</h2>

<p><a href="http://weblog.rubyonrails.org/2016/6/30/Rails-5-0-final/">Rails 5.0</a> requires <a href="https://www.ruby-lang.org/en/news/2015/04/13/ruby-2-2-2-released/">Ruby 2.2.2</a> or later.</p>

<p>This Ruby upgrade shouldn&#39;t generate any problems. However, if you run into this
exception in your test suite:</p>

<p><code>cannot load such file -- test/unit/assertions (Load Error)</code></p>

<p>then you&#39;ll need to add:</p>

<p><code>gem &#39;test-unit&#39;</code></p>

<p>to your <code>Gemfile</code>.</p>

<h2 id="gems">2. Gems</h2>

<ul>
<li>It&#39;s recommended that you check your <code>Gemfile</code> against <a href="http://www.ready4rails.net">Ready4Rails</a>
to check whether you have any older gems which may not be compatible with Rails
5 yet. (As of the release of this blog post, there are only a few gems which
don&#39;t support Rails 5 yet, this is more of a problem when you&#39;re upgrading
early on).</li>
</ul>

<p>If any of the gems are missing on Ready4Rails, you&#39;ll need to check the Github
page for the project manually. In case you own the gem, you&#39;ll need to make sure
they work on Rails 5 or update it.</p>

<h2 id="config-files">3. Config files</h2>

<p>Rails includes the <code>rails app:update</code> <a href="http://edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html#the-update-task">task</a>.
You can use this task as a guideline as explained thoroughly in
<a href="http://thomasleecopeland.com/2015/08/06/running-rails-update.html">this post</a>.</p>

<p>As an alternative, check out <a href="http://railsdiff.org/4.2.10/5.0.6">RailsDiff</a>,
which provides an overview of the changes in a basic Rails app between 4.2.x and
5.0.x (or any other source/target versions).</p>

<h2 id="application-code">4. Application code</h2>

<p><h3 id="active-record">a. ActiveRecord</h2></p>

<ul>
<li>ActiveRecord models will now inherit from ApplicationRecord by default instead
of ActiveRecord::Base. You should create an <code>application_record.rb</code> file under
<code>app/models</code> with:</li>
</ul>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="k">class</span> <span class="nc">ApplicationRecord</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="nb">self</span><span class="o">.</span><span class="n">abstract_class</span> <span class="o">=</span> <span class="kp">true</span>
<span class="k">end</span>
</code></pre></div>

<p>And then update all of your models to inherit from <code>ApplicationRecord</code> instead
of <code>ActiveRecord::Base</code>. The only class that inherits from <code>ActiveRecord::Base</code>
will be <code>ApplicationRecord</code>.</p>

<ul>
<li><code>belongs_to</code> associations are <a href="https://github.com/rails/rails/pull/18937/files">now required by default</a>.
This means that if the association doesn&#39;t exist for a model when saving it, an
error will be triggered. You can turn this feature off for an association by
using <code>optional: true</code>:</li>
</ul>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="n">belongs_to</span> <span class="ss">:user</span><span class="p">,</span> <span class="ss">optional</span><span class="p">:</span> <span class="kp">true</span>
</code></pre></div>

<p><h3 id="controllers">b. Controllers</h2></p>

<ul>
<li>If you&#39;re not already using strong parameters, and still rely on
<code>protected_attributes</code>, you should migrate your application to strong
parameters before attempting to upgrade to Rails 5.0.
<a href="https://github.com/rails/protected_attributes"><code>protected_attributes</code></a> is
no longer supported on Rails 5.0.</li>
</ul>

<p>A few months ago we worked on a project to attempt to automate this strong
parameters migration process with the gem <a href="https://github.com/fastruby/rails_upgrader">RailsUpgrader</a>.</p>

<p>There are still efforts being made to keep <code>protected_attributes</code> alive though,
like the <a href="https://github.com/westonganger/protected_attributes_continued"><code>protected_attributes_continued</code></a>
gem, but I would strongly recommend against using it.</p>

<ul>
<li>Parameters now behave differently, they no longer inherit from
<code>HashWithIndifferentAccess</code>. Some methods (e.g.: <code>fetch</code>, <code>slice</code>, <code>except</code>) you
may be now calling on <code>params</code> will no longer work. You will need to <code>permit</code>
the parameters, call <code>to_h</code>, and only then you&#39;ll be able to run the <code>Hash</code>
methods you need on them.</li>
</ul>

<p>For more information: <a href="https://github.com/rails/rails/pull/20868">https://github.com/rails/rails/pull/20868</a></p>

<h2 id="testing">5. Testing</h2>

<ul>
<li>One of the most common methods in controller tests, <code>assigns</code>, has been
extracted from Rails and moved to the <a href="https://github.com/rails/rails-controller-testing"><code>rails-controller-testing</code></a> gem.
If you wish to continue using it (and <code>assert_template</code>), you&#39;ll need to add it
to your <code>Gemfile</code>:</li>
</ul>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="n">gem</span> <span class="s1">&#39;rails-controller-testing&#39;</span>
</code></pre></div>

<ul>
<li>Instead of using <code>ActionDispatch::Http::UploadedFile</code> to test uploads, you&#39;ll
need to update those tests to use <a href="http://www.rubydoc.info/github/brynary/rack-test/Rack/Test/UploadedFile"><code>Rack::Test::UploadedFile</code></a>.</li>
</ul>

<h2 id="next-steps">6. Next steps</h2>

<p>If you successfully followed all of these steps, you should now be running Rails 5.0! Do you have any other useful tips or recommendations? Share them with us in the comments section.</p>

<p>If you don&#39;t have the time to upgrade your Rails app, check out our <a href="https://fastruby.io">Ruby on Rails
upgrade</a> service: <a href="https://fastruby.io">FastRuby.io</a></p>

        </section>

        

        <footer class="post-footer">
          
            
            <figure class="author-image">
              
                <a class="img" href="" style="background-image: url(//2.gravatar.com/avatar/350875eb8fce8553e12040c5a1f5d5d0?s=50)">
                <span class="hidden">Mauro Otonelli's Picture</span></a>
              
            </figure>
            <section class="author">
              <h4> Mauro Otonelli </h4>
              <p>
                We are the Lean Software Boutique. Check us out at <a href="https://www.ombulabs.com">www.ombulabs.com</a>
              </p>
            </section>
          

          <!-- Share links section -->
          <section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" href="http://twitter.com/share?text=Upgrade Rails from 4.2 to 5.0&amp;url=https://www.ombulabs.com/blog/rails/upgrades/upgrade-rails-from-4-2-to-5-0.html"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://www.ombulabs.com/blog/rails/upgrades/upgrade-rails-from-4-2-to-5-0.html"
        onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=https://www.ombulabs.com/blog/rails/upgrades/upgrade-rails-from-4-2-to-5-0.html"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>


          <!-- Disqus comments -->
          <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">

        var disqus_shortname = 'ombulabs';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


        </footer>

    </article>
    <footer class="site-footer clearfix">
  <section class="copyright">
    <figure>
      <img src="/blog/assets/images/creative-commons.png"
           alt="Creative Commons Attribution-NonCommercial">
      <figcaption>
        <a href="http://creativecommons.org/licenses/by-nc/3.0/"
           target="_blank"
           title="Creative Commons Attribution-NonCommercial">Creative Commons Attribution-NonCommercial</a>
      </figcaption>
    </figure>
  </section>
  <section class="poweredby">Made with love using <a href="https://github.com/jekyll/jekyll" target="_blank">Jekyll</a> and
    <a target="_blank" href="http://github.com/rosario/kasper">Kasper theme</a>
  </section>
</footer>

</main>

      <div id="sidebar">
  <h2 class="category-name">Listing all tags</h2>
    

    
    
        <h3 class="tag-name">
          <a href="/blog/tags/"
             title="Articles about "></a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/agile"
             title="Articles about Agile">Agile</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/aws"
             title="Articles about Aws">Aws</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/backbone"
             title="Articles about Backbone">Backbone</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/benchmark"
             title="Articles about Benchmark">Benchmark</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/best-practices"
             title="Articles about Best Practices">Best Practices</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/bugs"
             title="Articles about Bugs">Bugs</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/carrierwave"
             title="Articles about Carrierwave">Carrierwave</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/case-study"
             title="Articles about Case Study">Case Study</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/circle-ci"
             title="Articles about Circle Ci">Circle Ci</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/continuous-integration"
             title="Articles about Continuous Integration">Continuous Integration</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/conventions"
             title="Articles about Conventions">Conventions</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/crowdsourcing"
             title="Articles about Crowdsourcing">Crowdsourcing</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/design"
             title="Articles about Design">Design</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/docker"
             title="Articles about Docker">Docker</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/dry"
             title="Articles about Dry">Dry</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/git"
             title="Articles about Git">Git</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/github"
             title="Articles about Github">Github</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/hubot"
             title="Articles about Hubot">Hubot</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/imap"
             title="Articles about Imap">Imap</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/jobs"
             title="Articles about Jobs">Jobs</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/lean-startup"
             title="Articles about Lean Startup">Lean Startup</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/learning"
             title="Articles about Learning">Learning</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/linux"
             title="Articles about Linux">Linux</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/maintenance"
             title="Articles about Maintenance">Maintenance</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/monit"
             title="Articles about Monit">Monit</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/mvp"
             title="Articles about Mvp">Mvp</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/open-source"
             title="Articles about Open Source">Open Source</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/pair-programming"
             title="Articles about Pair Programming">Pair Programming</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/performance"
             title="Articles about Performance">Performance</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/protractor"
             title="Articles about Protractor">Protractor</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/rails"
             title="Articles about Rails">Rails</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/react"
             title="Articles about React">React</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/rspec"
             title="Articles about Rspec">Rspec</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/ruby"
             title="Articles about Ruby">Ruby</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/rubygems"
             title="Articles about Rubygems">Rubygems</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/s3"
             title="Articles about S3">S3</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/security"
             title="Articles about Security">Security</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/sessions"
             title="Articles about Sessions">Sessions</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/slack"
             title="Articles about Slack">Slack</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/software-development"
             title="Articles about Software Development">Software Development</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/software-quality"
             title="Articles about Software Quality">Software Quality</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/team"
             title="Articles about Team">Team</a>
        </h3>
    
        <h3 class="tag-name">
          <a href="/blog/tags/upgrades"
             title="Articles about Upgrades">Upgrades</a>
        </h3>
    
</div>

    </div>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
    <script type="text/javascript" src="/blog/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-17795190-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</body>
</html>
