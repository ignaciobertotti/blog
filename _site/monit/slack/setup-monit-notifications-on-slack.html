<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Article">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><title>Setup Monit Notifications on Slack - The Lean Software Boutique</title><meta name="description" content="Monit is a powerful tool for monitoring processes on Unix systems and sometimes it can be very useful to receive notifications about a specific pro..." />
    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="Setup Monit Notifications on Slack - The Lean Software Boutique">
    <meta itemprop="description" content="Monit is a powerful tool for monitoring processes on Unix systems and sometimes it can be very useful to receive notifications about a specific pro...">
    <!-- meta itemprop="image" content="http://www.example.com/image.jpg" -->

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@OmbuLabs">

    <meta name="twitter:title" content="Setup Monit Notifications on Slack - The Lean Software Boutique">
    <meta name="twitter:description" content="Monit is a powerful tool for monitoring processes on Unix systems and sometimes it can be very useful to receive notifications about a specific pro...">
    <meta name="twitter:creator" content="@OmbuLabs">
    <!-- Twitter summary card with large image must be at least 280x150px -->
    <!-- meta name="twitter:image:src" content="http://www.example.com/image.html" -->

    <!-- Open Graph data -->
    <meta property="og:title" content="Setup Monit Notifications on Slack - The Lean Software Boutique" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://www.ombulabs.com/blog/monit/slack/setup-monit-notifications-on-slack.html" />
    <meta property="og:image" content="https://www.ombulabs.com/assets/isotype.png" />
    <meta property="og:description" content="Monit is a powerful tool for monitoring processes on Unix systems and sometimes it can be very useful to receive notifications about a specific process from your server to your everyday tool, Slack. This article will show you exactly how to do that." />
    <meta property="og:site_name" content="Setup Monit notifications on Slack by @lubc32" /><meta property="article:published_time" content="2017-11-15 04:45:00 -0500" />
      <meta property="article:modified_time" content="2017-11-15 04:45:00 -0500" />
      <meta property="article:section" content="Monit is a powerful tool for monitoring processes on Unix systems and sometimes it can be very useful to receive notifications about a specific process from your server to your everyday tool, Slack. This article will show you exactly how to do that." />
      <meta property="article:tag" content="Setup Monit Notifications on Slack - The Lean Software Boutique" /><meta property="fb:admins" content="10153304864537860" />

    <link rel="stylesheet" type="text/css" href="/blog/assets/css/screen.css" />
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900,300italic,400italic,700italic|Maven+Pro" rel="stylesheet" type="text/css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/blog/assets/css/main.css" />
    <link rel="stylesheet" type="text/css" href="/assets/ombu_blog/application.css" />
</head>
<body class="home-template">
  <header class="main-header no-cover">
      <nav class="main-nav overlay clearfix"><a class="back-button icon-arrow-left"
                 href="/blog">Home</a>
          <a class="subscribe-button icon-feed" href="/blog/rss.xml">Subscribe</a>
      </nav>
      <div class="vertical">
          <div class="main-header-content inner">
              <h1 class="page-title logo"><a href="/blog">OmbuLabs Blog</a></h1>
              <h2 class="page-description slogan">The Lean Software Boutique</h2>
          </div>
      </div>
      <a class="scroll-down icon-arrow-left" href="#content" data-offset="-45"><span class="hidden">Scroll Down</span></a>
  </header>
    <div id="wrapper">
      <main class="content post-layout" role="main">

    <article class="post">

        <header class="post-header">
            <h1 class="post-title">Setup Monit notifications on Slack</h1>
            <section class="post-meta"><img class="author-thumb" src="//2.gravatar.com/avatar/9219f1f8634fafcbed16e72a0bb5a414?s=50" alt="Luciano Becerra" nopin="nopin" /><a href="/blog/authors/luciano"
     title="Articles by Luciano Becerra">
     Luciano Becerra
  </a>on
    
      <a href="/blog/tags/monit"
         title="Articles about Monit">Monit</a>,
      <a href="/blog/tags/slack"
         title="Articles about Slack">Slack</a><time class="post-date" datetime="2017-11-15">
  15 Nov 2017
</time>
</section>
        </header>

        <section class="post-content">
          <p><a href="https://mmonit.com/monit/">Monit</a> is a powerful tool for monitoring processes on <a href="https://en.wikipedia.org/wiki/Unix">Unix</a> systems and sometimes it can be very useful to receive notifications about a specific process from your server to your everyday tool, <a href="https://slack.com/">Slack</a>. This article will show you exactly how to do that.</p>

<!--more-->

<p>In the examples we are using a <a href="https://en.wikipedia.org/wiki/Linux">Linux</a> environment running <a href="https://www.ubuntu.com/">Ubuntu</a> <code>16.04</code>.
Also the process that we will be monitoring is <a href="https://projects.eclipse.org/projects/technology.mosquitto">Mosquitto</a>, but you can monitor any process just by changing the configuration.</p>

<h3>Setup Slack</h3>

<p>As a first step you need to create a new <a href="https://api.slack.com/incoming-webhooks">Incoming WebHook</a>. You can do that by going to <code>https://my.slack.com/services/new/incoming-webhook</code>, select or create a channel, and then click on <code>Add incoming WebHooks Integration</code>. Then you will see a <code>Webhook URL</code> that should be similar to this: <code>https://hooks.slack.com/services/T7W3HFJSO/B7XLPmQAZ/aviXjd5cKdzvzUjfWbCn8oEqr</code>. You will need that URL in the next step.</p>

<p>The second part requires you to create a <a href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)"> Bash </a> script that will post Slack messages when you run it.
This is an example of how this file should look like:</p>

<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>URL=&quot;https://hooks.slack.com/services/T7W3HFJSO/B7XLPmQAZ/aviXjd5cKdzvzUjfWbCn8oEqr&quot; # Slack Webhook URL

PAYLOAD=&quot;{
  \&quot;attachments\&quot;: [
    {
      \&quot;title\&quot;: \&quot;$PROCESS was restarted\&quot;,
      \&quot;color\&quot;: \&quot;warning\&quot;,
      \&quot;mrkdwn_in\&quot;: [\&quot;text\&quot;],
      \&quot;fields\&quot;: [
        { \&quot;title\&quot;: \&quot;Date\&quot;, \&quot;value\&quot;: \&quot;$MONIT_DATE\&quot;, \&quot;short\&quot;: true },
        { \&quot;title\&quot;: \&quot;Host\&quot;, \&quot;value\&quot;: \&quot;$MONIT_HOST\&quot;, \&quot;short\&quot;: true }
      ]
    }
  ]
}&quot;

curl -s -X POST --data-urlencode &quot;payload=$PAYLOAD&quot; $URL
</code></pre></div>

<p>If you want to see how to customize the Slack messages you can take a look at the <a href="https://api.slack.com/incoming-webhooks#sending_messages">official documentation</a>.</p>

<p>Before running the script we should add some permissions (I saved it as <code>slack-webhook.sh</code> in <code>/usr/local/bin/</code>)</p>

<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>$ sudo chmod u+x /usr/local/bin/slack-webhook.sh
</code></pre></div>

<p>Now let&#39;s run it to see if it&#39;s working</p>

<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>$ /usr/local/bin/slack-webhook.sh
</code></pre></div>

<p>If correct, you will see the message in your Slack channel.</p>

<p><img src="/blog/assets/images/monit-message.png" alt="Monit message"></p>

<p>It looks a bit empty because we didn&#39;t set any variables for the message to use (e.g. <code>$PROCESS</code>).</p>

<h3>Setup Monit</h3>

<p>You can see if you already have installed Monit by running</p>

<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>$ monit --version
This is Monit version 5.16
</code></pre></div>

<p>If not you can install it with
<code>
$ sudo apt install monit -y
</code></p>

<p>Now that you have Monit installed, you can add the configuration for your process on <code>/etc/monit/conf.d</code></p>

<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>check process mosquitto with pidfile /var/run/mosquitto.pid
  start program = &quot;/etc/init.d/mosquitto start&quot;
  stop program = &quot;/etc/init.d/mosquitto stop&quot;

  if changed pid then exec &quot;/bin/bash -c &#39;PROCESS=Mosquitto /usr/local/bin/slack-webhook.sh&#39;&quot;
  if 1 restart within 1 cycle then exec &quot;/bin/bash -c &#39;PROCESS=Mosquitto /usr/local/bin/slack-webhook.sh&#39;&quot;
</code></pre></div>

<p>This configuration will restart the process in case you stop it manually or if it gets stopped by itself. And when that happens it will call the <code>slack-webhook</code> script to publish a message in the Slack channel.
You can see a bunch of real-world configuration examples on <a href="https://mmonit.com/wiki/Monit/ConfigurationExamples">this link</a>.</p>

<p>Don&#39;t forget to restart Monit after you make changes in the configuration.</p>

<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>$ monit reload
Reinitializing monit daemon
</code></pre></div>

<p>You can easily test this by manually killing the process.</p>

<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>$ ps aux | grep mosquitto
mosquit+ 23073  0.0  0.2  44200  4916 ?        S    19:48   0:00 /usr/sbin/mosquitto -c /etc/mosquitto/mosquitto.conf

$ kill -9 23073
</code></pre></div>

<p>The process will be automatically restarted after a couple of seconds and you will receive a message in your Slack channel.</p>

<p><img src="/blog/assets/images/monit-message-2.png" alt="Monit message"></p>

<p>This is just one type of message that you can implement in your Slack team, but you can also do some cooler things with Monit, like sending reports or alerts. You just need to change the configuration files based on that.</p>

        </section><footer class="post-footer"><figure class="author-image"><a class="img" href="" style="background-image: url(//2.gravatar.com/avatar/9219f1f8634fafcbed16e72a0bb5a414?s=50)">
                <span class="hidden">Luciano Becerra's Picture</span></a></figure>
            <section class="author">
              <h4> Luciano Becerra </h4>
              <p>
                We are the Lean Software Boutique. Check us out at <a href="https://www.ombulabs.com">www.ombulabs.com</a>
              </p>
            </section><!-- Share links section --><section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" href="http://twitter.com/share?text=Setup Monit notifications on Slack&amp;url=https://www.ombulabs.com/blog/monit/slack/setup-monit-notifications-on-slack.html"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://www.ombulabs.com/blog/monit/slack/setup-monit-notifications-on-slack.html"
        onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=https://www.ombulabs.com/blog/monit/slack/setup-monit-notifications-on-slack.html"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>
<!-- Disqus comments --><section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">

        var disqus_shortname = 'ombulabs';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>
</footer>

    </article><footer class="site-footer clearfix">
  <section class="copyright">
    <figure>
      <img src="/blog/assets/images/creative-commons.png"
           alt="Creative Commons Attribution-NonCommercial">
      <figcaption>
        <a href="http://creativecommons.org/licenses/by-nc/3.0/"
           target="_blank"
           title="Creative Commons Attribution-NonCommercial">Creative Commons Attribution-NonCommercial</a>
      </figcaption>
    </figure>
  </section>
  <section class="poweredby">Made with love using <a href="https://github.com/jekyll/jekyll" target="_blank">Jekyll</a> and
    <a target="_blank" href="http://github.com/rosario/kasper">Kasper theme</a>
  </section>
</footer>
</main>
<div id="sidebar">
  <h2 class="category-name">Listing all tags</h2><h3 class="tag-name">
          <a href="/blog/tags/"
             title="Articles about "></a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/agile"
             title="Articles about Agile">Agile</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/aws"
             title="Articles about Aws">Aws</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/backbone"
             title="Articles about Backbone">Backbone</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/benchmark"
             title="Articles about Benchmark">Benchmark</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/best-practices"
             title="Articles about Best Practices">Best Practices</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/bugs"
             title="Articles about Bugs">Bugs</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/carrierwave"
             title="Articles about Carrierwave">Carrierwave</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/case-study"
             title="Articles about Case Study">Case Study</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/circle-ci"
             title="Articles about Circle Ci">Circle Ci</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/code-refactor"
             title="Articles about Code Refactor">Code Refactor</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/continuous-integration"
             title="Articles about Continuous Integration">Continuous Integration</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/conventions"
             title="Articles about Conventions">Conventions</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/crowdsourcing"
             title="Articles about Crowdsourcing">Crowdsourcing</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/design"
             title="Articles about Design">Design</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/docker"
             title="Articles about Docker">Docker</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/dry"
             title="Articles about Dry">Dry</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/git"
             title="Articles about Git">Git</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/github"
             title="Articles about Github">Github</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/hubot"
             title="Articles about Hubot">Hubot</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/imap"
             title="Articles about Imap">Imap</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/jobs"
             title="Articles about Jobs">Jobs</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/lean-startup"
             title="Articles about Lean Startup">Lean Startup</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/learning"
             title="Articles about Learning">Learning</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/linux"
             title="Articles about Linux">Linux</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/maintenance"
             title="Articles about Maintenance">Maintenance</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/monit"
             title="Articles about Monit">Monit</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/mvp"
             title="Articles about Mvp">Mvp</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/open-source"
             title="Articles about Open Source">Open Source</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/pair-programming"
             title="Articles about Pair Programming">Pair Programming</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/performance"
             title="Articles about Performance">Performance</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/pivotal-tracker"
             title="Articles about Pivotal Tracker">Pivotal Tracker</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/protractor"
             title="Articles about Protractor">Protractor</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/rails"
             title="Articles about Rails">Rails</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/react"
             title="Articles about React">React</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/rspec"
             title="Articles about Rspec">Rspec</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/ruby"
             title="Articles about Ruby">Ruby</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/rubygems"
             title="Articles about Rubygems">Rubygems</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/s3"
             title="Articles about S3">S3</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/security"
             title="Articles about Security">Security</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/sessions"
             title="Articles about Sessions">Sessions</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/slack"
             title="Articles about Slack">Slack</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/software-development"
             title="Articles about Software Development">Software Development</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/software-quality"
             title="Articles about Software Quality">Software Quality</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/team"
             title="Articles about Team">Team</a>
        </h3><h3 class="tag-name">
          <a href="/blog/tags/upgrades"
             title="Articles about Upgrades">Upgrades</a>
        </h3></div>
</div>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
    <script type="text/javascript" src="/blog/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-17795190-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</body>
</html>
